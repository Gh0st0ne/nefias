The script `eSim_Retransmission_tcpseq.sh` has the following special characteristics:

* Line 47-62: When extracting the retransmissions (or the sequence numbers) from all packets/TCP segments, the script checks for each packet in the flow in the order of arrival (i.e. in the unsorted list/array) whether any packet coming after it in the list has the same sequence number. If so, the sequence number is extracted/copied into the retransmission array. In case of multiple retransmissions, i.e. if a packet/TCP segment is transmitted more than once, the sequence numbers are extracted again. This means, each retransmission sequence number is extracted, possibly even several times (several times if a segment was retransmitted at least twice). After all, the list/array of retransmissions might contain a sequence number more than once. Please note: Flows that mostly contain only ACK packets contain a lot of retransmissions, i.e. almost all packets, since, here, retransmissions are only evaluated based on tcp.seq (the TCP sequence number). Such flows are often found in legitimate traffic. However, covert channels with the retransmission pattern, usually contain flows where the tcp_seq increases continuously.
* Line 64-67: There must be at least 3 retransmissions to calculate the epsilon similarity scores. Otherwise, an error because of division by 0 would occur in the remainder of the calculation. Therefore, if a flow has both enough packets (see head -n for window length) and less than 3 retransmissions within the window, the script will not calculate epsilon similarity scores but instead it prints out the information "no or not enough (<=2) retransmissions existent".
* Line 77-84: If a distance delta equals 0, the corresponding lambda value is also set to 0. This serves to avoid a division by 0, since delta is in the denominator of the quotient when calculating lambdas.


